/*! Script.js 1.0.0.0
 * 
 */
require(["ss","d3","Facebook","jquery"],function(n,t,i,$){function r(){}function u(n,t){this.index=0,this.name=n.name,this.id=n.id,this.index=t,this.links=[]}var o=this,f,e;r.$8=function(){var n={};n.scope="email",FB.login(function(){},n)},r.$9=function(){var t=$("#charge").val(),i=$("#distance").val();r.$a(null,n.emptyString(t)?-120:parseInt(t),n.emptyString(i)?80:parseInt(i))},r.$a=function(t,i,u){var f=n.now();$("#canvas").empty();var e=[],o=[];FB.api("/me/friends",function(n){!n.error?r.$b(i,u,f,e,o,n):$("body").append("Error: "+n.error.message)})},r.$b=function(n,t,i,f,e,o){for(var h,c,l,a,s=0;s<o.data.length;s++)h=new u(o.data[s],s),r.$1[h.id]=h,c={},c.name=h.name,c.group=1,c.id=h.id,f[f.length]=c;l={},l.friendsAll="SELECT uid1, uid2 from friend WHERE uid1 = me()",l.friendsoffriends="SELECT uid1, uid2 FROM friend WHERE uid1 IN (SELECT uid2 from #friendsAll) AND uid2 IN (SELECT uid2 from #friendsAll) AND uid1 < uid2",a={},a.method="fql.multiquery",a.queries=l,FB.api(a,function(u){r.$c(n,t,i,f,e,u)})},r.$c=function(t,i,u,f,e,o){for(var s,v,y,h=0;h<o[1].fql_result_set.length;h++){var a=o[1].fql_result_set[h],c=r.$1[a.uid1],l=r.$1[a.uid2];l.links.push(c.id),c.links.push(l.id),s={},s.source=l.index,s.target=c.index,s.value=1,e[e.length]=s}v=n.now(),y=u.getMilliseconds()-v.getMilliseconds(),$("body").append("query took: "+y/1e3),r.$d(t,i,f,e)},r.$d=function(n,i,u,f){var o=960,s=800,e;r.$5=t.behavior.zoom().scaleExtent([.4,4]).on("zoom",r.$f),e=t.layout.force().charge(n).linkDistance(i).size([o,s]),r.$6=t.select("#canvas").append("svg").attr("width",o).attr("height",s).call(r.$5).append("g"),e.nodes(u).links(f).start(),r.$3=r.$6.selectAll(".link").data(f).enter().append("line").attr("class","link").style("stroke-width",function(n){return Math.sqrt(n.value)}),r.$4=r.$6.selectAll(".node").data(u).enter().append("circle").attr("class","node").attr("r",7).call(e.drag).on("mousemove",r.$h).on("mouseover",r.$i).on("mouseout",r.$j).on("click",r.$e),r.$4.append("title").text(function(n){return n.name});e.on("tick",r.$g)},r.$e=function(n){r.$2=n.id===r.$2?null:n.id,r.$g()},r.$f=function(){r.$6.attr("transform","translate("+t.event.translate+")scale("+t.event.scale+")")},r.$g=function(){r.$3.attr("x1",function(n){return n.source.x}).attr("y1",function(n){return n.source.y}).attr("x2",function(n){return n.target.x}).attr("y2",function(n){return n.target.y}).style("stroke-width",function(n){return!!r.$2&&r.$k(n,r.$2)?2:1}),r.$4.attr("cx",function(n){return n.x}).attr("cy",function(n){return n.y}).attr("fill",function(n){return!!r.$2?r.$1[r.$2].links.indexOf(n.id)>=0?"red":n.id===r.$2?"green":"black":"black"})},r.$h=function(){t.event.stopPropagation();var n=$("#callout")},r.$i=function(i){var r,u;t.event.stopPropagation(),r=$("#callout"),r.show(),u="<p><img src='http://graph.facebook.com/{0}/picture' alt='{1}' height='100' width='100'><\/p><p>{1}<\/p>",r.html(n.format(u,i.id,i.name))},r.$j=function(){t.event.stopPropagation();var n=$("#callout");n.hide()},r.$k=function(n,t){return n.source.id===t||n.target.id===t},r.$l=function(){FB.logout(function(){})},r.$m=function(){$("#login").click(r.$8),$("#graph").click(r.$9);var n={};n.appId="459808530803920",n.channelUrl="http://jsff.asurewebsites.com/channel.aspx",n.status=!0,n.cookie=!0,n.xfbml=!1,FB.init(n),FB.getLoginStatus(function(n){n.status==="connected"&&(r.$0=n.authResponse.userID)}),FB.Event.subscribe("auth.authResponseChange",function(n){n.status==="connected"&&(r.$0=n.authResponse.userID)})},f={},e=n.module("Script",{FFJS:[r,null,null]},{Friend:[u,f,null]}),r.$1={},r.$2=null,r.$7=!0,$(r.$m)})