/*! Script.js 1.0.0.0
 * 
 */
require(["ss","d3","Facebook","jquery"],function(n,t,i,$){function r(){}function u(n,t){this.index=0,this.name=n.name,this.id=n.id,this.index=t,this.links=[]}var o=this,f,e;r.$7=function(){var n={};n.scope="email, user_likes, publish_stream",FB.login(function(){},n)},r.$8=function(){var n=[],i=[];FB.api("/me/friends",function(f){for(var o,s,h,c,e=0;e<f.data.length;e++)o=new u(f.data[e],e),r.$1[o.id]=o,s={},s.name=o.name,s.group=1,s.id=o.id,n[n.length]=s;h={},h.friendsLimit="SELECT uid1, uid2 from friend WHERE uid1 = "+r.$0+" ORDER BY uid2",h.friendsAll="SELECT uid1, uid2 from friend WHERE uid1 = "+r.$0,h.friendsoffriends="SELECT uid1, uid2 FROM friend WHERE uid1 IN (SELECT uid2 from #friendsLimit) AND uid2 IN (SELECT uid2 from #friendsAll) AND uid1 < uid2",c={},c.method="fql.multiquery",c.queries=h,FB.api(c,function(u){for(var f,c,l,o,e=0;e<u[2].fql_result_set.length;e++){var a=u[2].fql_result_set[e],s=r.$1[a.uid1],h=r.$1[a.uid2];h.links.push(s.id),s.links.push(h.id),f={},f.source=h.index,f.target=s.index,f.value=1,i[i.length]=f}c=960,l=500,r.$5=t.behavior.zoom().scaleExtent([-100,100]).on("zoom",r.$9),o=t.layout.force().charge(-120).linkDistance(30).size([c,l]),r.$6=t.select("#canvas").append("svg").attr("width",c).attr("height",l).call(r.$5).append("g"),o.nodes(n).links(i).start(),r.$3=r.$6.selectAll(".link").data(i).enter().append("line").attr("class","link").style("stroke-width",function(n){return Math.sqrt(n.value)}),r.$4=r.$6.selectAll(".node").data(n).enter().append("circle").attr("class","node").attr("r",7).call(o.drag).on("mousemove",r.$b).on("mouseover",r.$c).on("mouseout",r.$d),r.$4.append("title").text(function(n){return n.name});o.on("tick",r.$a)})})},r.$9=function(){r.$6.attr("transform","translate("+t.event.translate+")scale("+t.event.scale+")")},r.$a=function(){r.$3.attr("x1",function(n){return n.source.x}).attr("y1",function(n){return n.source.y}).attr("x2",function(n){return n.target.x}).attr("y2",function(n){return n.target.y}).style("stroke-width",function(n){return!!r.$2&&r.$e(n,r.$2)?2:1}),r.$4.attr("cx",function(n){return n.x}).attr("cy",function(n){return n.y}).attr("fill",function(n){return!!r.$2?r.$1[r.$2].links.indexOf(n.id)>=0?"red":n.id===r.$2?"green":"black":"black"})},r.$b=function(n){t.event.stopPropagation();var i=$("#callout");i.css("left",n.x+20),i.css("top",n.y+50)},r.$c=function(i){var u,f;t.event.stopPropagation(),r.$2=i.id,r.$a(),u=$("#callout"),u.show(),f="<p><img src='http://graph.facebook.com/{0}/picture' alt='{1}' height='100' width='100'><\/p><p>{1}<\/p>",u.html(n.format(f,i.id,i.name))},r.$d=function(){t.event.stopPropagation(),r.$2=null,r.$a();var n=$("#callout");n.hide()},r.$e=function(n,t){return n.source.id===t||n.target.id===t},r.$f=function(){FB.logout(function(){})},r.$g=function(){$("#login").click(r.$7),$("#graph").click(r.$8);var n={};n.appId="459808530803920",n.channelUrl="http://jsff.asurewebsites.com/channel.aspx",n.status=!0,n.cookie=!0,n.xfbml=!1,FB.init(n),FB.getLoginStatus(function(n){n.status==="connected"&&(r.$0=n.authResponse.userID)}),FB.Event.subscribe("auth.authResponseChange",function(n){n.status==="connected"&&(r.$0=n.authResponse.userID)})},f={},e=n.module("Script",{FFJS:[r,null,null]},{Friend:[u,f,null]}),r.$1={},r.$2=null,$(r.$g)})